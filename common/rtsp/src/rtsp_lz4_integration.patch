# RTSP库LZ4集成补丁说明
# 
# 需要在rtsp.c中进行以下修改以集成LZ4支持

## 1. 在文件顶部添加包含
#include "rtsp_demo_lz4.h"

## 2. 在rtsp_session结构中添加LZ4帧信息存储（第67-98行）
在vcodec_data union之后添加：
    // LZ4扩展数据
    rtsp_lz4_frame_info_t lz4_frame_info;

## 3. 在rtsp_set_video函数中添加LZ4支持（第551-558行）
case RTSP_CODEC_ID_VIDEO_H264:
case RTSP_CODEC_ID_VIDEO_H265:
    break;
case RTSP_CODEC_ID_VIDEO_LZ4:
    // LZ4支持，使用rtsp_set_video_lz4
    break;
default:
    err("not supported codec_id %d for video\n", codec_id);
    return -1;

## 4. 在build_simple_sdp函数中添加LZ4 SDP生成（第700-710行）
case RTSP_CODEC_ID_VIDEO_H264:
    ...
    break;
case RTSP_CODEC_ID_VIDEO_H265:
    ...
    break;
case RTSP_CODEC_ID_VIDEO_LZ4:
    p += rtsp_build_sdp_media_attr_lz4(VRTP_PT_ID, s->vrtpe.sample_rate,
                                        &s->lz4_frame_info, p, maxlen - (p - sdpbuf));
    break;

## 5. 在rtsp_tx_video函数中添加LZ4发送支持（第1872-1924行）
case RTSP_CODEC_ID_VIDEO_H264:
    ...
    break;
case RTSP_CODEC_ID_VIDEO_H265:
    ...
    break;
case RTSP_CODEC_ID_VIDEO_LZ4:
    // 直接发送压缩数据（不需要NALU解析）
    // 注意：这里需要将compressed_data作为LZ4数据发送
    return rtsp_tx_video_lz4(session, frame, len, ts);

## 6. 修改rtsp_set_video_lz4以存储frame_info
在rtsp_lz4.c的rtsp_set_video_lz4函数中添加：
    // 存储帧信息
    memcpy(&s->lz4_frame_info, frame_info, sizeof(rtsp_lz4_frame_info_t));

